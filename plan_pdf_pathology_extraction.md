# Task Plan for PDF Pathology Extraction and Report Generation

## Overview

This project involves extracting pathology data from uploaded PDF files, generating a comprehensive report PDF that includes multiple pages with specific content, and integrating a summary generated by a custom GPT model via an API.

## Current Functionality

- **Form Input (index.html):** Users upload a PDF and enter detailed information about the inspector, client, and property.
- **Pathology Extraction:** Using `extractor_pathologies.py`, pathology data is extracted from the PDF.
- **PDF Generation (extractorv2.py):** Multiple pages are generated and composed into a final report PDF:
  - Custom front page with branding.
  - Page 2 and Page 4 from static PDFs.
  - Dynamic Page 3 generated from user form data.
  - Pathology table pages.
  - Terms and last pages.

## New Requirements

1. **Summary Page Generation via Custom GPT API:**
   - Integrate with a custom GPT endpoint at `https://chatgpt.com/c/6772e2f0-2f98-8011-88d8-e9c7e1ded797`.
   - Send the uploaded PDF file to this GPT for summarization.
   - Receive the summary text response.
   - Generate a new PDF page containing this summary.
   - Insert this summary page into the final report PDF during composition.

2. **Modular Implementation:**
   - Create a new module for OpenAI API integration:
     - Store API keys and connection details in a separate config file.
     - Implement the function to send the PDF and receive the summary.
     - Implement PDF page generation for the summary.
   - Modify `extractorv2.py` to:
     - Import and call the new summary generation function.
     - Insert the summary page in the correct position in the final PDF.
   - Ensure existing code remains unchanged and stable.

## Detailed Steps

### 1. Create `openai_config.py`
- Store OpenAI API key and any necessary configuration.

### 2. Create `pdf_summary.py`
- Implement:
  - Function to send PDF to the custom GPT API endpoint.
  - Function to generate a PDF page with the summary text.

### 3. Modify `extractorv2.py`
- Import summary functions from `pdf_summary.py`.
- Generate summary page during report composition.
- Insert summary page between appropriate pages.

### 4. Modify `app.py`
- Pass uploaded PDF file or path to `extractorv2.py` for summary generation.

## UX and Code Quality
- Maintain clean, modular, and well-documented code.
- Ensure all new features integrate seamlessly without breaking existing functionality.
- Follow best practices for PDF layout and user input handling.

---

Please review this plan and confirm if you approve or want to suggest any changes before implementation.